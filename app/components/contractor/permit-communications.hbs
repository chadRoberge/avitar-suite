<div class="avitar-card">
  <div class="avitar-card__header avitar-flex avitar-justify-between avitar-items-center">
    <h3 class="avitar-card__title">
      <i class="fas fa-comments avitar-mr-2"></i>
      Communications
    </h3>
    <button
      type="button"
      class="avitar-btn avitar-btn--primary avitar-btn--sm"
      {{on "click" @onAddComment}}
    >
      <i class="fas fa-plus avitar-mr-2"></i>
      Add Message
    </button>
  </div>
  <div class="avitar-card__body">
    {{#if this.publicComments.length}}
      <div class="avitar-space-y-4">
        {{#each this.publicComments as |comment|}}
          <div class="avitar-card avitar-bg-gray-50">
            <div class="avitar-card__body avitar-p-4">
              <div class="avitar-flex avitar-gap-3">
                <div class="avitar-flex-shrink-0">
                  <div class="avitar-w-10 avitar-h-10 avitar-rounded-full avitar-bg-primary avitar-text-white avitar-flex avitar-items-center avitar-justify-center avitar-font-semibold">
                    {{substring comment.author.name 0 1}}
                  </div>
                </div>
                <div class="avitar-flex-1">
                  <div class="avitar-flex avitar-items-start avitar-justify-between avitar-mb-2">
                    <div>
                      <div class="avitar-font-semibold">
                        {{comment.author.name}}
                        {{#if (eq comment.author._id @currentUser._id)}}
                          <span class="avitar-badge avitar-badge--sm avitar-badge--secondary avitar-ml-2">You</span>
                        {{/if}}
                      </div>
                      <div class="avitar-text-xs avitar-text-muted">
                        {{date-format comment.createdAt "MMM DD, YYYY h:mm a"}}
                      </div>
                    </div>
                  </div>
                  <p class="avitar-text-sm">{{comment.text}}</p>
                </div>
              </div>
            </div>
          </div>
        {{/each}}
      </div>
    {{else}}
      <div class="avitar-empty-state avitar-py-8">
        <i class="fas fa-comments fa-3x avitar-text-muted avitar-mb-4"></i>
        <h3 class="avitar-text-lg avitar-font-semibold avitar-mb-2">
          No Messages Yet
        </h3>
        <p class="avitar-text-muted avitar-mb-4">
          Start a conversation with the municipality about this permit.
        </p>
        <button
          type="button"
          class="avitar-btn avitar-btn--primary"
          {{on "click" @onAddComment}}
        >
          <i class="fas fa-plus avitar-mr-2"></i>
          Send Your First Message
        </button>
      </div>
    {{/if}}
  </div>
</div>
